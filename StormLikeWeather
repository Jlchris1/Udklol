-- 🌧️ Full Rainstorm Environment Script with Gloomy Blue Atmosphere 🌧️
-- Place this in ServerScriptService

local Lighting = game:GetService("Lighting")
local Workspace = game:GetService("Workspace")

-- 🌫️ Basic lighting settings
Lighting.FogStart = 0.3
Lighting.FogEnd = 120
Lighting.Brightness = 0
Lighting.ClockTime = 14
Lighting.OutdoorAmbient = Color3.fromRGB(50, 70, 100)
Lighting.EnvironmentDiffuseScale = 0.3
Lighting.EnvironmentSpecularScale = 0.2
Lighting.GlobalShadows = true

-- 🔄 Clean up previous sky/cloud/atmosphere/effects
for _, obj in pairs(Lighting:GetChildren()) do
	if obj:IsA("Sky") or obj:IsA("Clouds") or obj:IsA("Atmosphere") 
	   or obj:IsA("BloomEffect") or obj:IsA("BlurEffect") 
	   or obj:IsA("ColorCorrectionEffect") then
		obj:Destroy()
	end
end

-- ☁️ Add heavy storm clouds
local clouds = Instance.new("Clouds")
clouds.Cover = 1
clouds.Density = 1
clouds.Color = Color3.fromRGB(60, 70, 100)
clouds.Parent = Lighting

-- ☁️ Add stormy blue sky
local sky = Instance.new("Sky")
sky.SkyboxUp = "http://www.roblox.com/asset/?id=4495867486"
sky.SkyboxRt = "http://www.roblox.com/asset/?id=4495866584"
sky.SkyboxLf = "http://www.roblox.com/asset/?id=4495866035"
sky.SkyboxFt = "http://www.roblox.com/asset/?id=4495865458"
sky.SkyboxDn = "http://www.roblox.com/asset/?id=4495864887"
sky.SkyboxBk = "http://www.roblox.com/asset/?id=4495864450"
sky.SkyboxOrientation = Vector3.new(0,0,0)
sky.StarCount = 0
sky.CelestialBodiesShown = false
sky.Parent = Lighting

-- 🌫️ Add atmosphere for depth and gloomy blue tone
local atmosphere = Instance.new("Atmosphere")
atmosphere.Density = 0.7
atmosphere.Offset = 0.25
atmosphere.Color = Color3.fromRGB(70, 90, 120)
atmosphere.Decay = Color3.fromRGB(40, 50, 70)
atmosphere.Glare = 0
atmosphere.Haze = 2
atmosphere.Parent = Lighting

-- ✨ Bloom for cinematic look
local bloom = Instance.new("BloomEffect")
bloom.Intensity = 6
bloom.Threshold = 0.8
bloom.Size = 56
bloom.Parent = Lighting

-- 🌫️ Blur effect for gloom
local blur = Instance.new("BlurEffect")
blur.Size = 10
blur.Parent = Lighting

-- 🎨 Color correction to tint environment blue
local colorCorrection = Instance.new("ColorCorrectionEffect")
colorCorrection.Saturation = -0.4
colorCorrection.Contrast = 0.1
colorCorrection.TintColor = Color3.fromRGB(80, 90, 130)
colorCorrection.Parent = Lighting

-- 💧 Make all existing parts look wet
for _, part in pairs(Workspace:GetDescendants()) do
	if part:IsA("BasePart") then
		part.Reflectance = 0.4
	end
end

-- 🌧️ Rain particle system
local rainPart = Instance.new("Part")
rainPart.Name = "RainEmitter"
rainPart.Size = Vector3.new(2000, 1, 2000)
rainPart.Anchored = true
rainPart.CanCollide = false
rainPart.Transparency = 1
rainPart.Position = Vector3.new(0, 200, 0)
rainPart.Parent = Workspace

local rain = Instance.new("ParticleEmitter")
rain.Texture = "rbxassetid://241717196"
rain.Rate = 1200
rain.Lifetime = NumberRange.new(1, 1.5)
rain.Speed = NumberRange.new(50, 60)
rain.VelocitySpread = 20
rain.Rotation = NumberRange.new(0, 360)
rain.RotSpeed = NumberRange.new(-50, 50)
rain.Size = NumberSequence.new(0.2)
rain.Parent = rainPart

-- 🔊 Add rain sound
local rainSound = Instance.new("Sound")
rainSound.SoundId = "rbxassetid://911882737" -- Heavy rain sound
rainSound.Looped = true
rainSound.Volume = 0.6
rainSound.Playing = true
rainSound.Parent = Workspace

-- 🔁 Keep clouds maxed
task.spawn(function()
	while true do
		clouds.Cover = 1
		clouds.Density = 1
		task.wait(10)
	end
end)
