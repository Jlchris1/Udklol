--// Rain Script: Creates heavy camera-attached rain emitters that stay upright
--// Recommended: Place this in StarterPlayerScripts as a LocalScript

-- Remove any existing splash emitters / attachments in the place
local function removeSplashObjects()
    -- Remove ParticleEmitters named "RainSplash"
    for _, obj in ipairs(game:GetDescendants()) do
        if obj:IsA("ParticleEmitter") and obj.Name == "RainSplash" then
            pcall(function() obj:Destroy() end)
        end
    end

    -- Remove Attachments named "__RainSplashAttachment"
    for _, obj in ipairs(game:GetDescendants()) do
        if obj:IsA("Attachment") and obj.Name == "__RainSplashAttachment" then
            pcall(function() obj:Destroy() end)
        end
    end

    -- Also remove any Part/Folder named "__RainSplashAttachment"
    for _, obj in ipairs(game:GetDescendants()) do
        if (obj:IsA("BasePart") or obj:IsA("Folder")) and obj.Name == "__RainSplashAttachment" then
            pcall(function() obj:Destroy() end)
        end
    end
end

removeSplashObjects()

-- Remove old emitter if it exists
if workspace:FindFirstChild("Camera") and workspace.Camera:FindFirstChild("__RainEmitter") then
    workspace.Camera.__RainEmitter:Destroy()
elseif workspace.CurrentCamera and workspace.CurrentCamera:FindFirstChild("__RainEmitter") then
    workspace.CurrentCamera.__RainEmitter:Destroy()
end

-- Create the main invisible emitter part
local emitterPart = Instance.new("Part")
emitterPart.Name = "__RainEmitter"
emitterPart.Anchored = true
emitterPart.CanCollide = false
emitterPart.Transparency = 1
emitterPart.Size = Vector3.new(200, 10, 200)

-- Parent to workspace.Camera if it exists, otherwise to workspace.CurrentCamera
if workspace:FindFirstChild("Camera") then
    emitterPart.Parent = workspace.Camera
else
    emitterPart.Parent = workspace.CurrentCamera or workspace
end

-- Keep emitter following the cameraâ€™s *position* but high above and upright
local RunService = game:GetService("RunService")

RunService.RenderStepped:Connect(function()
    local cam = workspace.CurrentCamera
    if cam and emitterPart then
        -- Position emitter 50 studs above camera
        local camPos = cam.CFrame.Position
        local highPos = camPos + Vector3.new(0, 50, 0)
        emitterPart.CFrame = CFrame.new(highPos)
    end
end)

-- Helper function to create emitter
local function createEmitter(name, textureId, sizeSeq)
    local emitter = Instance.new("ParticleEmitter")
    emitter.Name = name
    emitter.Texture = textureId
    emitter.LightInfluence = 0
    emitter.LockedToPart = false
    emitter.EmissionDirection = Enum.NormalId.Bottom
    emitter.Lifetime = NumberRange.new(2, 2) -- Longer lifespan
    emitter.Rate = 5000 -- Very high spawn rate
    emitter.Speed = NumberRange.new(60, 60)
    emitter.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 1),
        NumberSequenceKeypoint.new(0.1, 0),
        NumberSequenceKeypoint.new(0.9, 0),
        NumberSequenceKeypoint.new(1, 1)
    })
    emitter.Size = sizeSeq
    emitter.Color = ColorSequence.new(Color3.new(1, 1, 1))
    emitter.Parent = emitterPart
    return emitter
end

-- Create only RainStraight emitter
createEmitter("RainStraight", "rbxassetid://1822883048", NumberSequence.new({
    NumberSequenceKeypoint.new(0, 10),
    NumberSequenceKeypoint.new(1, 10)
}))

print("[Rain Script] Heavy upright camera rain emitter created 50 studs above camera. Lifespan = 2s, Rate = 5000. All RainSplash objects removed.")
